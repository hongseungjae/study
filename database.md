# 데이터베이스
### noSQL 과 RDB 의 특징, 차이에 대해 말씀해주세요. 어느 상황에 어떤 데이터베이스를 쓰는게 좋겠습니까?
* 내 대답 : RDB같은 경우는 정형화된 데이터로 텍스트를 저장합니다. noSQL은 같은 경우는 형식이 정해져 있지 않은 이미지나 그런 형식을 저장할 수 있고, 좀 더 빠르고 가벼운 데이터를 저장하는데 사용합니다. 토큰값이나 어떤 세션값을 저장 할 수 있습니다.
* 정답 : 
https://pythontoomuchinformation.tistory.com/528
### 데이터베이스가 자료를 빠르게 검색하기 위해 어떤 일을 할까요? 최대한 상세하게 설명해주세요.

### RDBMS 의 여러 JOIN 중 아무거나 하나 골라서, 그림으로 설명해 주실 수 있습니까?

### 데이터베이스 샤딩 / 파티셔닝에 대해 설명해주세요.
볼륨이 커지면 커질수록 데이터베이스 읽기/쓰기 성능은 감소
-> 거대한 데이터셋을 서브셋으로 분리하여 관리하는 방법 - 샤딩과 파티셔닝

파티셔닝은 매우 큰 테이블을 여러개의 테이블로 분할하는 작업

샤딩은 여러대의 데이터베이스 서버들에 데이터를 작은 단위로 나누어 분산 저장하는 기법
-> 데이터베이스에 각각 분할하여 저장하므로, 여러 샤드에 걸친 데이터를 조인하는 것이 어렵다. 또한, 한 데이터베이스에 집중적으로 데이터가 몰리면 Hotspot이 되어 성능이 느려진다. 따라서 데이터를 여러 샤드로 고르게 분배하는 것이 중요하
모듈러 샤딩 : 나머지 연산을 사용한
range 샤딩 : PK 값을 범위로 지정하여

### 데이터베이스가 Index 를 이용해 자료를 빠르게 검색하는 과정을, 우리 할머니도 알아들을 수 있도록 설명해 주시겠어요?
* 내 대답 : 전체 값 중에 하나하나 찾는게(풀 스캔) 아니라 쭉 정렬해놓고 반반씩 쪼개서 찾는것입니다.(인덱스 테이블 스캔)
* 단점 : 당연히 인덱스 관리해주어야함 예를 들어 인설트나 델리트나 업데이트할 시 인덱스도 같이 해줘야함, 따라서 빈번하면 오히려 역효과
* 인덱스 저장 공간도 필요

### Stored procedure 를 이용한 시스템을 어떻게 유지보수 할 수 있습니까? Stored procedure 의 장점과 단점에 대해 말씀해 주세요.
* DB 내부에 저장된 일련의 SQL 명령문들을 하나의 함수처럼 실행하기 위한 쿼리의 집합.
* 저장프로시저의 두번째 실행부터는 캐시(메모리)에 있는 것을 가져와서 사용하므로 속도가 빨라진다. 또한, 여러개의 쿼리를 한번에 실행할 수 있다.
* 직접 SQL문을 호출하지 않고 저장 프로시저의 이름을 호출하도록 설정하여 사용하는 경우가 많은데, 이때 개발자는 수정요건이 발생할때 코드 내 SQL문을 건드리는게 아니라 SP 파일만 수정하면 되기 때문에 유지보수 측면에서 유리
* 클라이언트에서 서버로 쿼리의 모든 텍스트가 전송될 경우 네트워크에는 큰 부하가 발생하게 된다. 하지만 저장 프로시저를 이용한다면 저장 프로시저의 이름, 매개변수 등 몇글자만 전송하면 되기 때문에 부하를 크게 줄일 수 있다.
DB 확장 어려움
서비스 사용자가 많아져 서버의 수를 늘려야할 때, DB의 수를 늘리는 것이 더 어렵다. 또한, DB 교체는 거의 불가능하다.

📚데이터 분석의 어려움
개발된 프로시저가 여러 곳에서 사용 될 경우 수정했을 때 영향의 분석이 어렵다(별도의 Description 사용).
배포, 버전 관리 등에 대한 이력 관리가 힘들다.
APP에서 SP를 호출하여 사용하는 경우 문제가 생겨도 해당 이슈에 대한 추적이 힘들다(별도의 에러 테이블 사용).
📚낮은 처리 성능
문자, 숫자열 연산에 SP를 사용하면 오히려 c, java보다 느린 성능을 보일 수 있다

### Optimistic Locking(낙관적 락) 과 Pessimistic Locking(비관적 락) 에 대해 설명해주세요. 각각의 락을 사용할 상황 또는 제품 사례를 말씀해주세요.
* 낙관적 락
자원에 락을 걸어서 선점하지말고, 동시성 문제가 발생하면 그때 가서 처리 하자는 방법론
어플리케이션단에서 처리
여러 작업이 묶인 트랜잭션으로 요청이 간 경우가 실패한경우, 개발자가 직접 롤백 처리 를 해주어야합니다.

* 비관적 락
자원 요청에 따른 동시성문제가 발생할것이라고 예상하고 락을 걸어버리는 방법론
데이터 무결성을 보장하는 수준이 매우 높습니다.
동시성이 떨어져 성능 손해를 많이 보게 됩니다
서로 자원이 필요한 경우에, 락이 걸려있으므로 데드락이 일어날 가능성이 있습니다

### 어떤 서비스의 이용자 테이블이 있다고 가정합시다. 이용자 id 를 여러 테이블에서 FK 로 참조하고 있습니다. 그런데 이용자 테이블에 환경설정, 개인정보 등 정보를 한데 저장하다보니 Column 이 40개가 넘게 있는 상태입니다. 문제를 진단해 주시고, 해결 방안도 제시해 주시기 바랍니다.
* 내 대답 : 컬럼이 40개가 넘어가면 일단 테이블이 엄청 크다고 생각합니다. 데이터가 쌓이면 쌓일수록 성능이 더더욱 나빠질 것입니다. 따라서 테이블 분리를 먼저 진행 할 것 같습니다.
* 정답 : 
정규화를 통한 테이블 분리 -> 분리하면 데이터를 검색하거나 갱신할 때, 성능 문제와 데이터 일관성 문제를 줄일 수 있습니다.
수직분할 (파티셔닝) -> 개인정보 등 민감한 정보는 따로 관리, 민감한 정보에 대한 접근 권한을 관리하기 용이하고, 민감한 정보에 대한 접근을 제한할 수 있습니다
수평분할 (샤딩) -> 

### Slow query 를 발견하고, 수정한 경험에 대해 말씀해 주세요.
 문제를 진단하기 위해 Slow Query Log를 확인하고, 해당 쿼리에 대한 실행 계획을 분석해 보았습니다.

그 결과, 해당 쿼리는 대용량 테이블에서 Join을 사용하는 복잡한 쿼리였으며, 인덱스를 효율적으로 사용하지 못해 전체 테이블 스캔을 수행하고 있었습니다. 이로 인해 쿼리의 실행 속도가 매우 느려지고 있었습니다.

이 문제를 해결하기 위해, 저는 다음과 같은 작업을 수행했습니다.

인덱스를 추가하였습니다.
쿼리의 실행 계획을 변경하였습니다.
쿼리 결과를 캐시하는 기능을 추가하였습니다.
먼저 인덱스를 추가한 것은, 해당 테이블의 Join 대상 컬럼에 인덱스를 추가하여 데이터 조회 속도를 높이기 위한 것입니다. 인덱스 추가 후, 쿼리 실행 속도가 개선되었습니다.

또한, 쿼리의 실행 계획을 변경하였습니다. 실행 계획을 변경하면, MySQL 옵티마이저가 더 효율적인 실행 계획을 생성할 수 있게 됩니다. 이를 통해 쿼리의 실행 속도가 더욱 개선되었습니다.


### 저희는 도축장에서 전달받은 원육을 소매점에 도매하는 서비스를 운영하고 있습니다. 여기서, 원육과 소매점을 어떻게 테이블로 모델링 하시겠습니까?
원육 테이블 (meat)
소매점 테이블 
원육-소매점 매핑 테이블
각각의 테이블이 서로 분리되어 있기 때문에 원육과 소매점 정보를 각각 수정할 때 다른 테이블에 영향을 주지 않고, 각각의 테이블에서 원하는 정보를 빠르게 검색할 수 있습니다. 또한 매핑 테이블에서는 원육과 소매점 간의 매핑 정보를 관리하기 때문에, 원육의 재고량 등의 정보도 효율적으로 관리할 수 있습니다.

============
다대다 관계 피하기

### 어플리케이션의 문자열(String) 을 데이터베이스에 저장하기 위해 고려해야 할 사항에는 어떤 점이 있을까요?
* 크기를 고려해야될 것 같습니다. 데이터베이스의 형식보다 큰 스트링을 저장할 때 수용할 수 있는지 파악해야 될 것 같아요

### Big data 를 다루려면 RDBMS 보다 NoSQL 이 더 좋다는 말이 많습니다. 그렇다면 large data set 에는 항상 NoSQL 만 써야 할까요? 반드시 RDBMS 만을 이용해 large data set 을 다루려면 어떻게 해야 할까요?
* 일단 NoSql은 데이터 일관성 정합성을 고려하지 않았기때문에 그런 단점들도 있고,
* RDBMS를 사용해야만 한다면 larage data set을 다루기 위해 최대한 효율을 높이기 위해 샤딩이나 파티셔닝을 구현할 것 같습니다

* chat : 만약 데이터의 구조가 명확하고 일관적이며, 복잡한 쿼리를 수행해야 한다면 RDBMS가 더 적합할 수 있습니다. 하지만, 데이터의 구조가 유연하지 않고 스키마가 자주 변경되는 경우 NoSQL이 더 유리할 수 있습니다.

대용량 데이터 처리를 위해서는 RDBMS에서 사용되는 인덱스, 파티셔닝, 샤딩 등의 기술을 사용할 수 있습니다. 또한, 데이터베이스 서버를 클러스터링하거나 수직적 확장을 통해 처리 능력을 향상시킬 수 있습니다.

하지만, 이러한 기술을 사용하더라도 데이터의 규모가 상당히 커질 경우에는 NoSQL이 더욱 적합할 수 있습니다. NoSQL은 분산 처리, 수평적 확장, 클러스터링 등의 기술을 사용하여 대용량 데이터 처리를 효율적으로 수행할 수 있습니다.

### 실 서비스의 데이터를 조작하고, 또 조회해야 하는 Admin app 을 만들어야 한다면, 어떻게 구현하시겠습니까?

### 데이터 마이그레이션 기간 동안 서비스 순단을 최소한으로 하고 싶습니다. 이런 요구사항에 맞는 테이블을 어떻게 설계하시겠습니까?

### (JPA 경험자 한정) JPA 를 이용할 때, JPQL 을 쓰는 경우가 종종 있는데, JPQL 을 쓰시며 좋았던 점과 불편했던 점을 말씀해 주세요.

### (JPA 경험자 한정) JPA 의 @Entity 란 뭔가요? 도메인 객체와 Entity 객체를 각각 어떻게 정의하시겠습니까?

### JPA , MyBatis
